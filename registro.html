<!DOCTYPE html>
<html lang="es">
  <head class="masthead" >
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Registro - Servi</title>
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
    <link
      href="https://fonts.googleapis.com/css?family=Montserrat:400,700"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700"
      rel="stylesheet"
    />
    <script
      src="https://use.fontawesome.com/releases/v6.3.0/js/all.js"
      crossorigin="anonymous"
    ></script>
    <link rel="stylesheet" href="css/styles.css" />
    <!-- Tagify CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.css">
  </head>


  <body id="page-top" class="body-registro">
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top navbar-servi-fondo" id="mainNav">
      <div class="container">
        <a class="navbar-brand" href="index.html"
          ><img src="assets/img/logos/ServiBlanco.png" alt="Logo"
        /></a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarResponsive"
        >
          Menu
          <i class="fas fa-bars ms-1"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav text-uppercase ms-auto py-4 py-lg-0">
            <li class="nav-item">
              <a class="nav-link" href="index.html#categorias">Categorias</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="index.html#contact">Contacto</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Formulario de Registro -->
    <section class="page-section" style="padding-top: 120px;">
      <div class="container">
        <div class="text-center">
          <h2 class="section-heading text-uppercase">Registro</h2>
          <h3 class="section-subheading text-muted">
            Crea tu cuenta para acceder a todos los servicios.
          </h3>
        </div>

        <form id="registroForm" class="row g-3">
          <div class="col-12">
            <label for="tipoUsuario" class="form-label">Tipo de usuario</label>
            <select class="form-select" id="tipoUsuario" required>
              <option value="">Seleccionar...</option>
              <option value="cliente">Cliente</option>
              <option value="proveedor">Proveedor de servicios</option>
            </select>
          </div>
          <div class="col-md-6">
            <label for="nombre" class="form-label">Nombre</label>
            <input type="text" class="form-control" id="nombre" required />
          </div>
          <div class="col-md-6">
            <label for="apellido" class="form-label">Apellido</label>
            <input type="text" class="form-control" id="apellido" required />
          </div>
          <div class="col-md-6">
            <label for="email" class="form-label">Correo Electrónico</label>
            <div class="input-group">
              <span class="input-group-text"><i class="fas fa-envelope"></i></span>
              <input type="email" class="form-control" id="email" required />
            </div>
            <small id="emailFeedback" class="form-text text-muted" aria-live="polite"></small>            
          </div>
          <div class="col-md-6">
            <label for="telefono" class="form-label">Teléfono</label>
            <input type="tel" class="form-control" id="telefono" />
          </div>
          <div class="col-md-6">
            <label for="password" class="form-label">Contraseña</label>
            <input type="password" class="form-control" id="password" required />
          </div>
          <div class="col-md-6">
            <label for="confirmarPassword" class="form-label"
              >Confirmar Contraseña</label
            >
            <input
              type="password"
              class="form-control"
              id="confirmarPassword"
              required
            />
          </div>
          <!-- CAMPOS SOLO PARA PROVEEDORES -->
          <div id="camposProveedor" class="row g-3 d-none mt-3">
            <div class="col-md-6">
              <label for="nombreEmpresa" class="form-label">Nombre de la empresa</label>
              <input type="text" class="form-control" id="nombreEmpresa" />
            </div>
            <div class="col-md-6">
              <label for="categoriaServicio" class="form-label">Categorías del servicio</label>
              <input type="text" class="form-control" id="categoriaServicio" placeholder="Ej: limpieza, electricidad, etc." />
              <small class="form-text text-muted">Elegí una o varias categorías. Podés escribir nuevas si no aparecen.</small>
            </div>
            <div class="col-md-12">
              <label for="descripcionServicio" class="form-label">Descripción del servicio</label>
              <textarea class="form-control" id="descripcionServicio" rows="3"></textarea>
            </div>
            <div class="col-md-6">
              <label for="ubicacionEmpresa" class="form-label">Ubicación de la empresa</label>
              <input type="text" class="form-control" id="ubicacionEmpresa" />
            </div>
            <div class="col-md-6">
              <label for="certificados" class="form-label">Certificados de capacitación</label>
              <input type="file" class="form-control" id="certificados" multiple />
            </div>
            <div class="col-md-12">
              <label for="imagenesLogo" class="form-label">Logo o imágenes del servicio</label>
              <input type="file" class="form-control" id="imagenesLogo" multiple />
            </div>
            <div class="col-md-12">
              <div id="preview" class="d-flex flex-wrap mt-3"></div>
            </div>
            
          </div>

          <div class="col-12 text-center mt-4">
            <button type="submit" class="btn btn-primary btn-xl text-uppercase">
              Registrarse
            </button>
          </div>
        </form>
      </div>
    </section>

    <script src="js/scripts.js"></script>
    <script>
      const tipoUsuarioSelect = document.getElementById("tipoUsuario");
      const camposProveedor = document.getElementById("camposProveedor");
    
      // Validación de email en tiempo real
document.getElementById("email").addEventListener("input", function () {
  const email = this.value;
  const feedback = document.getElementById("emailFeedback");
  if (!email.includes("@")) {
    feedback.textContent = "El correo debe contener '@'";
    feedback.style.color = "red";
  } else {
    feedback.textContent = "Formato válido";
    feedback.style.color = "green";
  }
});

// Vista previa de imágenes
document.getElementById("imagenesLogo").addEventListener("change", function () {
  const previewContainer = document.getElementById("preview");
  previewContainer.innerHTML = "";
  Array.from(this.files).forEach(file => {
    const reader = new FileReader();
    reader.onload = function (e) {
      const img = document.createElement("img");
      img.src = e.target.result;
      img.style.maxWidth = "150px";
      img.style.margin = "10px";
      previewContainer.appendChild(img);
    };
    reader.readAsDataURL(file);
  });
});

      tipoUsuarioSelect.addEventListener("change", function () {
        if (this.value === "proveedor") {
          camposProveedor.classList.remove("d-none");
        } else {
          camposProveedor.classList.add("d-none");
        }
      });
    
      document.getElementById("registroForm").addEventListener("submit", function (e) {
        e.preventDefault();
    
        const tipo = tipoUsuarioSelect.value;
        if (!tipo) {
          alert("Seleccioná el tipo de usuario.");
          return;
        }
    
        if (tipo === "proveedor") {
          const nombreEmpresa = document.getElementById("nombreEmpresa").value;
          const categoria = document.getElementById("categoriaServicio").value;
          const descripcion = document.getElementById("descripcionServicio").value;
    
          if (!nombreEmpresa || !categoria || !descripcion) {
            alert("Completá todos los campos requeridos del proveedor.");
            return;
          }
        }
    
        // Envío simulado
        alert("¡Registro enviado con éxito!");
        // Aquí iría el envío real (por fetch, AJAX, etc.)
      });
    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/@yaireo/tagify"></script>

    <!-- Fragmento mejorado de registro.html para guardar en LocalStorage -->
    <script>
      // Activar Tagify en el campo de categorías
      var input = document.getElementById('categoriaServicio');
      var tagify = new Tagify(input, {
        whitelist: ["limpieza", "electricidad", "peluquería", "niñera", "plomería", "jardinería", "barbería", "masajes", "gasista", "costura", "carpintería"],
        dropdown: {
          enabled: 0,           // muestra sugerencias al escribir
          fuzzySearch: true,    // activa búsqueda parcial
          position: "all",      // muestra lista debajo
          caseSensitive: false
        }
      });
    </script>
    
  <script>
  document.getElementById("registroForm").addEventListener("submit", function (e) {
    e.preventDefault();

    const tipo = document.getElementById("tipoUsuario").value;
    const nombre = document.getElementById("nombre").value;
    const apellido = document.getElementById("apellido").value;
    const email = document.getElementById("email").value;
    const telefono = document.getElementById("telefono").value;
    const password = document.getElementById("password").value;

    const usuario = {
      tipo,
      nombre,
      apellido,
      email,
      telefono,
      password
    };

    if (tipo === "proveedor") {
      usuario.empresa = document.getElementById("nombreEmpresa").value;
      usuario.categoria = document.getElementById("categoriaServicio").value;
      usuario.descripcion = document.getElementById("descripcionServicio").value;
      usuario.ubicacion = document.getElementById("ubicacionEmpresa").value;
      usuario.certificados = [...document.getElementById("certificados").files].map(f => f.name);
      usuario.imagenes = [...document.getElementById("imagenesLogo").files].map(f => f.name);
    }

    // Obtener lista actual
    const lista = JSON.parse(localStorage.getItem("usuariosServi")) || [];

    // Agregar nuevo usuario
    lista.push(usuario);

    // Guardar de nuevo
    localStorage.setItem("usuariosServi", JSON.stringify(lista));

    alert("¡Registro guardado en el navegador!");
    this.reset();
    document.getElementById("camposProveedor").classList.add("d-none");
  });
</script>

  </body>
</html>
